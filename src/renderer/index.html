<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vox Settings</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app">
    <header class="header">
      <div class="header-title">
        <img alt="Vox" class="header-logo" id="header-logo">
        <span>Vox</span>
      </div>
      <span class="header-subtitle">Settings</span>
    </header>

    <nav class="tabs">
      <button class="tab active" data-tab="llm">LLM Provider</button>
      <button class="tab" data-tab="whisper">Whisper Model</button>
      <button class="tab" data-tab="shortcuts">Shortcuts</button>
      <button class="tab" data-tab="permissions">Permissions</button>
    </nav>

    <main class="content">
      <!-- LLM Provider Tab -->
      <div class="tab-panel active" id="panel-llm">
        <div class="card">
          <div class="card-header">
            <h2>LLM Provider</h2>
            <p class="card-description">Configure the language model used for post-processing transcriptions.</p>
          </div>
          <div class="card-body">
            <div class="field">
              <label for="llm-provider">Provider</label>
              <select id="llm-provider">
                <option value="foundry">Microsoft Foundry</option>
                <option value="bedrock">AWS Bedrock</option>
              </select>
            </div>

            <!-- Foundry fields -->
            <div id="fields-foundry">
              <div class="field">
                <label for="llm-endpoint">Endpoint</label>
                <input type="url" id="llm-endpoint" placeholder="https://your-resource.services.ai.azure.com/anthropic">
              </div>
              <div class="field">
                <label for="llm-apikey">API Key</label>
                <div class="input-group">
                  <input type="password" id="llm-apikey" placeholder="Enter your API key">
                  <button class="icon-btn" id="toggle-apikey" title="Show/hide key">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                      <circle cx="12" cy="12" r="3"/>
                    </svg>
                  </button>
                </div>
              </div>
              <div class="field">
                <label for="llm-model">Model</label>
                <input type="text" id="llm-model" placeholder="gpt-4o">
              </div>
            </div>

            <!-- Bedrock fields -->
            <div id="fields-bedrock" style="display: none">
              <div class="field">
                <label for="llm-region">Region</label>
                <input type="text" id="llm-region" placeholder="us-east-1">
              </div>
              <div class="field">
                <label for="llm-profile">AWS Profile</label>
                <input type="text" id="llm-profile" placeholder="default">
                <p class="field-hint">Optional. Named profile from ~/.aws/credentials. Ignored when Access Key ID is provided.</p>
              </div>
              <div class="field">
                <label for="llm-access-key">Access Key ID</label>
                <div class="input-group">
                  <input type="password" id="llm-access-key" placeholder="Leave empty to use default credentials">
                  <button class="icon-btn" id="toggle-access-key" title="Show/hide key">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                      <circle cx="12" cy="12" r="3"/>
                    </svg>
                  </button>
                </div>
                <p class="field-hint">Optional. If empty, uses AWS default credential chain (env vars, ~/.aws/credentials, IAM roles).</p>
              </div>
              <div class="field">
                <label for="llm-secret-key">Secret Access Key</label>
                <div class="input-group">
                  <input type="password" id="llm-secret-key" placeholder="Leave empty to use default credentials">
                  <button class="icon-btn" id="toggle-secret-key" title="Show/hide key">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                      <circle cx="12" cy="12" r="3"/>
                    </svg>
                  </button>
                </div>
              </div>
              <div class="field">
                <label for="llm-model-id">Model ID</label>
                <input type="text" id="llm-model-id" placeholder="anthropic.claude-3-5-sonnet-20241022-v2:0">
              </div>
            </div>

            <div class="field" style="margin-top: 24px; border-top: 1px solid var(--border); padding-top: 20px;">
              <button class="btn btn-secondary btn-sm" id="llm-test-btn">Test Connection</button>
              <div id="llm-test-status" class="status-box"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Whisper Model Tab -->
      <div class="tab-panel" id="panel-whisper">
        <div class="card">
          <div class="card-header">
            <h2>Whisper Model</h2>
            <p class="card-description">Select the local speech recognition model. Larger models are more accurate but slower.</p>
          </div>
          <div class="card-body">
            <div id="model-list"></div>

            <div class="field" style="margin-top: 24px; border-top: 1px solid var(--border); padding-top: 20px;">
              <button class="btn btn-secondary btn-sm" id="whisper-test-btn">Test Whisper</button>
              <p class="field-hint">Records 5 seconds of audio and runs it through the selected model.</p>
              <div id="whisper-test-status" class="status-box"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Shortcuts Tab -->
      <div class="tab-panel" id="panel-shortcuts">
        <div class="card">
          <div class="card-header">
            <h2>Keyboard Shortcuts</h2>
            <p class="card-description">Configure the keyboard shortcuts for voice recording. Click a field and press your desired key combination.</p>
          </div>
          <div class="card-body">
            <div class="field">
              <label>Hold mode</label>
              <div class="shortcut-field" id="shortcut-hold" tabindex="0">
                <span class="shortcut-display"></span>
                <span class="shortcut-placeholder">Press shortcut...</span>
              </div>
              <input type="hidden" id="shortcut-hold-value">
              <p class="field-hint">Hold to record, release to stop.</p>
            </div>
            <div class="field">
              <label>Toggle mode</label>
              <div class="shortcut-field" id="shortcut-toggle" tabindex="0">
                <span class="shortcut-display"></span>
                <span class="shortcut-placeholder">Press shortcut...</span>
              </div>
              <input type="hidden" id="shortcut-toggle-value">
              <p class="field-hint">Press once to start, press again to stop.</p>
            </div>
            <button class="btn btn-secondary btn-sm" id="restore-defaults-btn" style="margin-top: 8px">Restore Defaults</button>
          </div>
        </div>
      </div>

      <!-- Permissions Tab -->
      <div class="tab-panel" id="panel-permissions">
        <div class="card">
          <div class="card-header">
            <h2>System Permissions</h2>
            <p class="card-description">Vox requires these macOS permissions to function properly.</p>
          </div>
          <div class="card-body">
            <div class="permission-row" id="perm-mic">
              <div class="permission-info">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/>
                  <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                  <line x1="12" y1="19" x2="12" y2="22"/>
                </svg>
                <div>
                  <div class="permission-name">Microphone</div>
                  <div class="permission-desc">Required for voice recording</div>
                </div>
              </div>
              <div class="permission-action">
                <span class="permission-badge granted" id="perm-mic-badge">Granted</span>
                <button class="btn btn-secondary btn-sm" id="perm-mic-btn" style="display:none">Grant Access</button>
              </div>
            </div>
            <div class="permission-row" id="perm-acc">
              <div class="permission-info">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                  <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                </svg>
                <div>
                  <div class="permission-name">Accessibility</div>
                  <div class="permission-desc">Required for auto-paste (Cmd+V simulation)</div>
                </div>
              </div>
              <div class="permission-action">
                <span class="permission-badge granted" id="perm-acc-badge">Granted</span>
                <button class="btn btn-secondary btn-sm" id="perm-acc-btn" style="display:none">Open Settings</button>
              </div>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top: 16px">
          <div class="card-header">
            <h2>Pipeline Test</h2>
            <p class="card-description">Record a 5-second audio sample to test transcription and LLM correction.</p>
          </div>
          <div class="card-body">
            <button class="btn btn-primary" id="test-btn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <circle cx="12" cy="12" r="3" fill="currentColor"/>
              </svg>
              Record 5s Test
            </button>
            <div id="status" class="status-box"></div>
          </div>
        </div>
      </div>
    </main>

  </div>

  <script src="../../dist/renderer/settings.js"></script>
</body>
</html>
